<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="search.css">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    </head>
    <body>
        <div id="search">
            <label for="query">Search:</label>
            <textarea type="text" id="query" name="query" placeholder="Enter a list of all your computer science interests separated by commas."></textarea>
            <button onclick="getTrackedElectives(document.getElementById('query').value)">Submit</button>
        </div>
        <div id="main">
            <h1>CSCE Tracked Elective Recommendation Tool</h1>
            <div id="tracks">
                <div class="track">
                    <h2>Track 1: Algorithms and Theory</h2>
                    <div id="Algorithms and Theory"></div>
                </div>
                <div class="track">
                    <h2>Track 2: Systems</h2>
                    <div id="Systems"></div>
                </div>
                <div class="track">
                    <h2>Track 3: Software</h2>
                    <div id="Software">
                    </div>
                </div>
                <div class="track">
                    <h2>Track 4: Information and Intelligent</h2>
                    <div id="Information and Intelligent Systems"></div>
                </div>
                <div class="track">
                    <h2>Untracked</h2>
                    <div id="Untracked"></div>
                </div>
            </div>
        </div>
    </body>
    <script>
        function getTrackedElectives(q) {
            $.ajax({
                url: 'http://127.0.0.1:5000/tracked',  // Ensure the correct URL
                type: 'GET',
                data: { query: q },
                success: function(response) {
                    console.log(response.type);  // Debugging line
                
                    for (const [track, electives] of Object.entries(response)) {
                        console.log(track)
                        const element = document.getElementById(track);
                        count = 0;
                        for (const elective of electives) {
                            count++;
                            const para = document.createElement("p");
                            const node = document.createTextNode(elective);
                            para.appendChild(node);
                            para.id = elective;
                            if (count == 1 && track != "Untracked") {
                                para.classList.add("green");
                            }
                            element.appendChild(para);
                            if (count > 5) {
                                break;
                            }
                        }
                    }
                },
                error: function(error) {
                    console.error('Error:', error);
                    document.getElementById("track1").innerText = "No tracks retrieved";
                }
            });
        }
    </script>
</html>